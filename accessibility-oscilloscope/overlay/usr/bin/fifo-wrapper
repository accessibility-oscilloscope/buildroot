#!/bin/sh

# fifo-wrapper: wrap a program in looping FIFO.
#
# usage:
# `fifo-wrapper $PROGRAM $IN $OUT`
#
# example:
# - `fifo-wrapper signal-compiler /run/signal-compiler /dev/stdout`
#   `cat test.signal > /run/signal-compiler`, writes output to stdout

mkfifo "$2" # by convention, reader makes pipe

while true; do
  eval "$1" < "$2" > "$3"
  [ $? -eq 0 ] || break
done
